<div class="adduser-dialog-container">
    <div class="adduser-title d-flex justify-content-between align-items-center">
        <h3>Edit User</h3>
        <img src="../../assets/close-icon.svg" alt="no-image" [mat-dialog-close]="true">
    </div>
    <form #basicForm="ngForm"
            class="dialog-section-wrapper" novalidate (ngSubmit)="basicForm.form.valid && update() ">
        <div class="search-wrap edit-search">
            <span class="input-label">Search for User in active directory</span>
            <mat-form-field class="form-input" appearance="standard" >
                <input class="toolbar-search" type="email" matInput placeholder="Enter Email ID" [(ngModel)]="local_data.emailId" name="useremail" disabled>
                <!-- <mat-error *ngIf="formControl.invalid">Please enter your email-id</mat-error> -->
            </mat-form-field>
        </div>
        <div class="roles-wrap">
            <span class="roles-title">Roles</span>
            <div class="roles-radio-btn">
                <mat-radio-group 
                    required
                    class="d-flex flex-wrap justify-content-between" 
                    #roleID = 'ngModel'
                    [(ngModel)]="local_role" name="userrole">
                    <mat-radio-button *ngFor="let option of userRoles" [value]="option.id">
                        {{option.name}}
                    </mat-radio-button>
                </mat-radio-group>
                <mat-error *ngIf="basicForm.submitted || (roleId?.invalid && (roleId.dirty || roleId.touched))">
                  <div *ngIf="roleId.errors" class="error-msg">
                    Please select Role
                  </div>
                </mat-error>
            </div>
        </div>
        <div class="roles-wrap selection-wrap d-flex flex-column">
            <span class="roles-title">Country</span>
            <mat-form-field appearance="fill">
                <mat-select 
                    required 
                    #countryId = 'ngModel'
                    [(ngModel)]="local_country" 
                    placeholder="Select Country" 
                    name="Select Country">
                  <mat-option *ngFor="let option of countries" [value]="option.id">
                    {{option.name}}
                  </mat-option>
                </mat-select>
                <!-- <mat-error *ngIf="formControl.invalid">Please select Country</mat-error> -->
              </mat-form-field>
              <mat-error *ngIf="basicForm.submitted || (countryId?.invalid && (countryId.dirty || countryId.touched))">
                <div *ngIf="countryId.errors" class="error-msg">
                  Please select Country
                </div>
              </mat-error>
        </div>
        <div *ngIf="local_role == 2"
        class="roles-wrap selection-wrap d-flex flex-column">
            <span class="roles-title">User Groups</span>
            <mat-form-field appearance="fill">
                <!-- <mat-error *ngIf="formControl.invalid">Please select User group</mat-error> -->
                <mat-select 
                    required
                    #usergroup = 'ngModel'
                    [(ngModel)]="local_group" 
                    placeholder="Select User group" 
                    name="Select User group" >
                  <mat-option *ngFor="let option of userGroups" [value]="option.id">
                    {{option.usergroup_name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-error *ngIf="basicForm.submitted || (usergroup?.invalid && (usergroup.dirty || usergroup.touched))">
                <div *ngIf="usergroup.errors" class="error-msg">
                  Please select User group
                </div>
              </mat-error>
        </div>

        <div *ngIf="local_role == 3 || local_role == 6" 
        class="roles-wrap  selection-wrap" >
          <span class="roles-title">Assign Level</span>
          <mat-tab-group >
            <mat-tab label={{tab.text}} *ngFor="let tab of treeData; let tabIndex = index">
              <div class="treeview-container">
  
                <div class="container">
                  <div id="accordion">
  
                      <div  *ngFor="let parent of treeData[tabIndex].children;let i=index">
                          <div class="tree-wrapper  d-flex justify-content-between align-items-center ">
                            <span>{{ parent.text }}</span>
                            <div class="d-flex align-items-center">
                              <mat-checkbox   class="example-margin" [(ngModel)]="parent.read" name="list_name_read{{i}}{{parent.value}}{{tabIndex}}"
                              (ngModelChange)="treeNodeSelection(parent, 'read', $event)"><span class="readLbl" >Read</span></mat-checkbox>
                              <mat-checkbox class="example-margin" [(ngModel)]="parent.write" name="list_name_write{{i}}{{parent.value}}{{tabIndex}}"
                              (ngModelChange)="treeNodeSelection(parent, 'write', $event)"   >Write</mat-checkbox>
                              <div  class="collapseIcon">
                              <button   type="button" class="btn" data-toggle="collapse" [attr.data-target]="'#collapseOne'+i"  aria-expanded="false"
                              aria-controls="collapseOne">
                              <i class="indicator fa fa-chevron-circle-down" aria-hidden="true"></i>
                              </button>
                            </div>
  
                          </div>
                        </div>
  
  
  
  
  
                        <div *ngFor="let child of parent.children ; let j=index" id="collapseOne{{i}}" class="collapse" aria-labelledby="headingOne"
                          data-parent="#accordion">
                          <div  id="child1">
                              <div class="tree-wrapper tab  d-flex justify-content-between align-items-center">
                                <span>  {{child.text }} </span>
                                <div class="d-flex align-items-center">
                                  <mat-checkbox  class="example-margin" [(ngModel)]="child.read" name="level2_name_read{{j}}{{child.value}}{{tabIndex}}" value="{{child.read}}"
                                  (ngModelChange)="treeNodeSelection(child, 'read', $event)"><span class="readLbl">Read</span></mat-checkbox>
                                  <mat-checkbox class="example-margin" [(ngModel)]="child.write" name="level2_name_write{{j}}{{child.value}}{{tabIndex}}" value="{{child.write}}"
                                  (ngModelChange)="treeNodeSelection(child, 'write', $event)"  >Write</mat-checkbox>
                                  <button type="button" class="btn"   data-toggle="collapse"  [attr.data-target]="'#collapseOneA'+j"> </button>
  
                                </div>
  
                                <!-- <span class="rwchkbox">
                                  </span>
                                </span>
                                <div  class="collapseIcon">
                                  <button class="btn"   data-toggle="collapse"  [attr.data-target]="'#collapseOneA'+j"> </button>
                                </div> -->
                              </div>
  
                              <div class="collapse" data-parent="#child1" id="collapseOneA{{j}}">
                              <div *ngFor="let child1 of child.children ; let k=index">
                                <div  id="child2">
                                    <div class="tree-wrapper tab1  d-flex justify-content-between align-items-center">
                                      <span>{{ child1.text }}</span>
                                      <div class="d-flex align-items-center">
                                        <mat-checkbox  style="margin-left: 439px;" [(ngModel)]="child1.read" name="last_level_name_read{{k}}{{child1.value}}{{tabIndex}}" value="{{child1.read}}"
                                        (ngModelChange)="treeNodeSelection(child1, 'read', $event)"><span class="readLbl">Read</span>
                                        </mat-checkbox>
                                        <mat-checkbox class="example-margin" [(ngModel)]="child1.write" name="last_level_name_write{{k}}{{child1.value}}{{tabIndex}}" value="{{child1.write}}"
                                          (ngModelChange)="treeNodeSelection(child1, 'write', $event)"  >Write</mat-checkbox>
                                          <button type="button" class="btn" href="#" data-toggle="collapse" [attr.data-target]="'#collapseOneB'+k">
                                          </button>
  
                                      </div>
        <!--
                                        </span>
                                      <div  class="collapseIcon">
                                      </div> -->
                                    </div>
                                    <div class="collapse" data-parent="#child2" id="collapseOneB{{k}}">
                                      <div *ngFor="let child2 of child1.children ; let m=index">
                                          <div  data-parent="#child3" id="collapseOneC{{m}}">
                                            <div id="child3">
                                            <div class="tree-wrapper tab2  d-flex justify-content-between align-items-center">
                                              <span>{{ child2.text }}</span>
                                              <div class="d-flex align-items-center">
                                                <mat-checkbox style="margin-left: 429px;" [(ngModel)]="child2.read" name="level4_chk_read{{m}}{{child2.value}}{{tabIndex}}" value="{{child2.read}}"
                                                (ngModelChange)="treeNodeSelection(child2, 'read', $event)"><span class="readLbl">Read</span>
                                                </mat-checkbox>
                                                <mat-checkbox class="example-margin" [(ngModel)]="child2.write" name="level4_chk_write{{m}}{{child2.value}}{{tabIndex}}" value="{{child2.write}}"
                                                  (ngModelChange)="treeNodeSelection(child2, 'write', $event)" >Write
                                                </mat-checkbox>
                                                <button type="button" class="btn" href="#" style="visibility: hidden;" >
                                                </button>
                                              </div>
                                              <!-- <span class="tab2">
  
                                              </span> -->
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
  
                  </div>
                </div>
  
              </div>
            </mat-tab>
          </mat-tab-group>
  
        </div>

        <div class="button-wrap d-flex justify-content-end">
            <button [mat-dialog-close]="true" class="cancel-btn">Cancel</button>
            <button type="submit" class="add-user" >Update</button>
        </div>
    </form>
</div>
